# SEO Implementation

This document describes the SEO implementation for ButterGolf web application.

## Overview

The SEO implementation includes:
- XML Sitemap generation (static and dynamic)
- robots.txt with proper directives
- JSON-LD structured data for rich search results
- Mobile app deep linking (Universal Links & App Links)

## Sitemap

### Static Sitemap
Generated by `next-sitemap` during build:
- **Location**: `public/sitemap.xml` (sitemap index)
- **Configuration**: `next-sitemap.config.js`
- **Generation**: Automatic via `postbuild` script

### Dynamic Sitemap
Server-generated sitemap for dynamic content:
- **Route**: `/server-sitemap.xml`
- **Implementation**: `src/app/server-sitemap.xml/route.ts`
- **Content**: Home, static pages, and all available products

### robots.txt
- **Location**: `public/robots.txt`
- **Generated by**: next-sitemap
- **References**: Both static and dynamic sitemaps

## Structured Data (JSON-LD)

### Helper Component
`src/components/seo/SeoJsonLd.tsx` - Injects JSON-LD into page head

### Implemented Schemas

#### Home Page
- **Organization**: Company information
- **WebSite**: Site-wide data with SearchAction

#### Product Pages
- **Product**: Product details with:
  - Offers (price, currency, availability)
  - Brand and model
  - Item condition
  - Seller information

### Adding JSON-LD to New Pages

```tsx
import { SeoJsonLd } from '@/components/seo';

export default function MyPage() {
  const schema = {
    "@context": "https://schema.org",
    "@type": "YourType",
    // ... your schema properties
  };

  return (
    <>
      <YourPageContent />
      <SeoJsonLd data={schema} />
    </>
  );
}
```

## Mobile App Deep Linking

### iOS Universal Links
**Configuration**: `public/.well-known/apple-app-site-association`

Requirements:
1. Update `YOUR_TEAM_ID` with actual Apple Team ID
2. File must be accessible at `https://buttergolf.com/.well-known/apple-app-site-association`
3. iOS app must include `associatedDomains` in `app.json`

### Android App Links
**Configuration**: `public/.well-known/assetlinks.json`

Requirements:
1. Update `REPLACE_WITH_YOUR_SHA256_FINGERPRINT` with signing key fingerprint
2. File must be accessible at `https://buttergolf.com/.well-known/assetlinks.json`
3. Android app must include `intentFilters` in `app.json`

### Expo Configuration
See `apps/mobile/app.json` for mobile app configuration:
- iOS: `associatedDomains` array
- Android: `intentFilters` array

## Environment Variables

```bash
# Required for sitemap generation and structured data
SITE_URL=https://buttergolf.com  # Production
SITE_URL=http://localhost:3000   # Development
```

## Testing

### Sitemap
1. Build the app: `pnpm build`
2. Check `public/sitemap.xml` exists
3. Check `public/robots.txt` references sitemaps
4. Test server sitemap: `curl http://localhost:3000/server-sitemap.xml`

### Structured Data
1. View page source (not inspector)
2. Search for `application/ld+json`
3. Validate with [Google Rich Results Test](https://search.google.com/test/rich-results)

### Mobile Deep Linking
1. Host files in production
2. Test iOS: Tap link in Messages/Mail with app installed
3. Test Android: Tap link in browser with app installed
4. Verify app opens instead of browser

## CI/CD

GitHub Actions workflow (`.github/workflows/seo-check.yml`) validates:
- Sitemap generation
- robots.txt format
- JSON-LD presence
- .well-known files

Runs on:
- Pull requests affecting web app
- Manual workflow dispatch

## Production Checklist

- [ ] Set `SITE_URL` environment variable
- [ ] Update Apple Team ID in `apple-app-site-association`
- [ ] Update Android SHA256 fingerprint in `assetlinks.json`
- [ ] Verify .well-known files are publicly accessible
- [ ] Submit sitemap to Google Search Console
- [ ] Test structured data with Google Rich Results Test
- [ ] Test deep linking on physical devices (iOS & Android)

## Maintenance

### Adding New Routes
1. Check if route should be indexed
2. Add to exclude list in `next-sitemap.config.js` if needed
3. Update priority in transform function if applicable

### Adding New Page Types
1. Determine appropriate schema type from [Schema.org](https://schema.org)
2. Add JSON-LD using `SeoJsonLd` component
3. Validate with Google Rich Results Test
4. Add to CI validation if critical page type

### Monitoring
- Google Search Console for crawl errors
- Check sitemap health regularly
- Monitor structured data errors

## Resources

- [Google Search Console](https://search.google.com/search-console)
- [Google Rich Results Test](https://search.google.com/test/rich-results)
- [Schema.org](https://schema.org)
- [next-sitemap Documentation](https://github.com/iamvishnusankar/next-sitemap)
- [Apple Universal Links](https://developer.apple.com/ios/universal-links/)
- [Android App Links](https://developer.android.com/training/app-links)
